---
# https://mynixos.com/nixpkgs/package/nezha-agent
# https://mynixos.com/nixpkgs/options/services.nezha-agent

# https://mynixos.com/nixpkgs/package/nezha-theme-admin
# https://github.com/hamster1963/nezha-dash
# https://mynixos.com/nixpkgs/package/nezha-theme-nazhua
# https://mynixos.com/nixpkgs/package/nezha

# https://github.com/nezhahq/nezha


version: '3.8'
services:
  nezha-server:
    image: nezha/dashboard:latest
    container_name: nezha-server
    ports:
      - "8008:8008" # Or your desired port
    environment:
      - NZ_DEBUG=false
      - NZ_GRPC_PORT=5555 # For agent communication
      # Add other necessary environment variables for database connection, etc.
    volumes:
      - ./data/nezha-server:/dashboard/data # Persist data

  nezha-agent:
    image: nezha/agent:latest
    container_name: nezha-agent
    environment:
      - NZ_SERVER=nezha-server:5555 # Connect to the server container
      - NZ_KEY=YOUR_AGENT_SECRET_KEY # Replace with your actual key
      # Add other environment variables as needed
    network_mode: host # Or connect to a custom network if preferred

# You might also include a database service (e.g., SQLite, MySQL, PostgreSQL)
# if you're not using the default embedded SQLite for the dashboard.
# Example for SQLite (if you want to manage its volume explicitly):
#   db:
#     image: alpine/git # A simple image to create a volume, or use a specific database image
#     volumes:
#       - ./data/nezha-db:/db
