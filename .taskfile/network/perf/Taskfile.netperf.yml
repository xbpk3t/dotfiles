---
version: '3'

tasks:
  tcp:
    desc: netperf TCP_STREAM
    summary: "task -g netperf:tcp HOST=1.1.1.1 [DURATION=10]"
    platforms: [linux]
    requires:
      vars: [HOST]
    vars:
      # DURATION 单位为秒（seconds）
      DURATION: '{{.DURATION | default "10"}}'
    preconditions:
      - sh: command -v netperf
        msg: netperf not found
    cmds:
      - netperf -H {{.HOST}} -t TCP_STREAM -l {{.DURATION}}

  udp:
    desc: netperf UDP_STREAM
    summary: "task -g netperf:udp HOST=1.1.1.1 [DURATION=10]"
    platforms: [linux]
    requires:
      vars: [HOST]
    vars:
      # DURATION 单位为秒（seconds）
      DURATION: '{{.DURATION | default "10"}}'
    preconditions:
      - sh: command -v netperf
        msg: netperf not found
    cmds:
      - netperf -H {{.HOST}} -t UDP_STREAM -l {{.DURATION}}
